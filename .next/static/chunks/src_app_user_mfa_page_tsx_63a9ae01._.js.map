{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sripathivamshi/Desktop/clerk-related/clerk/src/app/user/mfa/page.tsx"],"sourcesContent":["'use client'\n\nimport { useUser, useReverification } from '@clerk/nextjs'\nimport { TOTPResource } from '@clerk/types'\nimport Link from 'next/link'\nimport * as React from 'react'\n// QR rendering via external service to avoid extra dependency\n\n\ntype AddTotpSteps = 'add' | 'verify' | 'backupcodes' | 'success'\n\ntype DisplayFormat = 'qr' | 'uri'\n\nfunction AddTotpScreen({\n  setStep,\n}: {\n  setStep: React.Dispatch<React.SetStateAction<AddTotpSteps>>\n}) {\n  const { user } = useUser()\n  const [totp, setTOTP] = React.useState<TOTPResource | undefined>(undefined)\n  const [displayFormat, setDisplayFormat] = React.useState<DisplayFormat>('qr')\n  const createTOTP = useReverification(() => user?.createTOTP())\n\n  React.useEffect(() => {\n    void createTOTP()\n      .then((totp) => {\n        if (totp) {\n          setTOTP(totp)\n        }\n      })\n      .catch((err) =>\n        // See https://clerk.com/docs/guides/development/custom-flows/error-handling\n        // for more info on error handling\n        console.error(JSON.stringify(err, null, 2)),\n      )\n  }, [])\n\n  return (\n    <>\n      <h1>Add TOTP MFA</h1>\n\n      {totp && displayFormat === 'qr' && (\n        <>\n          <div>\n            <img\n              alt=\"Scan this QR in your authenticator app\"\n              width={200}\n              height={200}\n              src={`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(\n                totp?.uri || '',\n              )}`}\n            />\n          </div>\n          <button onClick={() => setDisplayFormat('uri')}>Use URI instead</button>\n        </>\n      )}\n      {totp && displayFormat === 'uri' && (\n        <>\n          <div>\n            <p>{totp.uri}</p>\n          </div>\n          <button onClick={() => setDisplayFormat('qr')}>Use QR Code instead</button>\n        </>\n      )}\n      <button onClick={() => setStep('add')}>Reset</button>\n\n      <p>Once you have set up your authentication app, verify your code</p>\n      <button onClick={() => setStep('verify')}>Verify</button>\n    </>\n  )\n}\n\nfunction VerifyTotpScreen({\n  setStep,\n}: {\n  setStep: React.Dispatch<React.SetStateAction<AddTotpSteps>>\n}) {\n  const { user } = useUser()\n  const [code, setCode] = React.useState('')\n\n  const verifyTotp = async (e: React.FormEvent) => {\n    e.preventDefault()\n    try {\n      await user?.verifyTOTP({ code })\n      setStep('backupcodes')\n    } catch (err) {\n      console.error(JSON.stringify(err, null, 2))\n    }\n  }\n\n  return (\n    <>\n      <h1>Verify TOTP</h1>\n      <form onSubmit={(e) => verifyTotp(e)}>\n        <label htmlFor=\"totp-code\">Enter the code from your authentication app</label>\n        <input type=\"text\" id=\"totp-code\" onChange={(e) => setCode(e.currentTarget.value)} />\n        <button type=\"submit\">Verify code</button>\n        <button onClick={() => setStep('add')}>Reset</button>\n      </form>\n    </>\n  )\n}\n\n// function BackupCodeScreen({\n//   setStep,\n// }: {\n//   setStep: React.Dispatch<React.SetStateAction<AddTotpSteps>>\n// }) {\n//   return (\n//     <>\n//       <h1>Verification was a success!</h1>\n//       <div>\n//         <p>\n//           Save this list of backup codes somewhere safe in case you need to access your account in\n//           an emergency\n//         </p>\n//         <GenerateBackupCodes />\n//         <button onClick={() => setStep('success')}>Finish</button>\n//       </div>\n//     </>\n//   )\n// }\n\nfunction SuccessScreen() {\n  return (\n    <>\n      <h1>Success!</h1>\n      <p>You have successfully added TOTP MFA via an authentication application.</p>\n    </>\n  )\n}\n\nexport default function AddMFaScreen() {\n  const [step, setStep] = React.useState<AddTotpSteps>('add')\n  const { isLoaded, isSignedIn, user } = useUser()\n\n  if (!isLoaded) {\n    // Handle loading state\n    return null\n  }\n\n  if (!isSignedIn) {\n    // Handle signed out state\n    return <p>You must be logged in to access this page</p>\n  }\n\n  return (\n    <>\n      {step === 'add' && <AddTotpScreen setStep={setStep} />}\n      {step === 'verify' && <VerifyTotpScreen setStep={setStep} />}\n      {step === 'success' && <SuccessScreen />}\n      <Link href=\"/account/manage-mfa\">Manage MFA</Link>\n    </>\n  )\n}"],"names":[],"mappings":"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","debugId":null}}]
}